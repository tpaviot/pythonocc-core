#!/bin/bash

# Configure step
EXTRA_CMAKE_ARGS=""
if [ "$(uname)" == "Darwin" ]; then
  EXTRA_CMAKE_ARGS="-DCMAKE_OSX_DEPLOYMENT_TARGET=10.13"
fi

cmake -G Ninja \
 -DCMAKE_BUILD_TYPE=Release \
 -DCMAKE_PREFIX_PATH=$PREFIX \
 -DCMAKE_LIBRARY_PATH:FILEPATH="$PREFIX/lib" \
 -DCMAKE_INSTALL_PREFIX:FILEPATH=$PREFIX \
 -DCMAKE_SYSTEM_PREFIX_PATH=$PREFIX \
  ${CMAKE_PLATFORM_FLAGS[@]} \
 -DPython3_FIND_STRATEGY=LOCATION \
 -DPython3_FIND_FRAMEWORK=NEVER \
 -DSWIG_HIDE_WARNINGS=ON \
 -DPYTHONOCC_MESHDS_NUMPY=ON \
 $EXTRA_CMAKE_ARGS

# Build step
ninja

# Install step
ninja install
